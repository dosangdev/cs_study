# 09장. 운영체제 시작하기

## 운영체제
프로그램에 메모리, CPU 자원을 할당하고 프로그램이 올바르게 실행되도록 돕는 특별한 프로그램.

- 메모리는 커널 영역과 사용자 영역으로 나뉜다.
- 운영체제는 커널 영역에, 일반 애플리케이션는 사용자 영역에 적재된다.

#### 개발자가 운영체제를 알아야 하는 이유
운영체제를 깊이 이해하면 운영제체에게 명령하는 것을 잘 할 수 있게되고, 하드웨어와 프로그램에 대한 이해가 높아진다.<br>
결과적으로 내 소프트웨어의 문제 해결에 도움이 될 수 있다. ex) 에러 메시지

## 커널
운영체제가 제공하는 기능 중 핵심 기능을 담당하는 부분.<br>
자원에 접근/조작하고, 프로그램의 실행을 돕는 기능이 핵심 기능이 해당한다.

일반적으로 OS라고 하면 커널의 기능을 가리켜 말하는 것이다.


##### 커널 외의 기능
ex) GUI, CLI

<img width="321" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/6e249a98-8709-4eb5-aa59-50480802e20f">
<img width="321" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/c3c47672-7053-4327-acc9-de5bb5a96983">


##### 이중 모드

>- 사용자 모드<br>
>운영체제 서비스를 제공받을 수 없는 모드. 자원  접근 X.<br>
>(응용 프로그램들은 기본적으로 사용자 모드로 실행된다.)
>
> - 커널 모드<br>
>운영체제 서비스를 제공받을 수 있는 모드. 자원 접근 O.

###### * 어떤 모드로 실행중인지는 플래그 레지스터 속 슈퍼바이저 플래그를 보면 알 수 있다.

사용자 모드의 프로그램은 **시스템 호출(시스템 콜)**을 통해 커널 모드로 전환하여 자원에 접근할 수 있다. 이를 소프트웨어 인터럽트라고 한다.

## 시스템 호출의 작동 과정
>1. 하드 디스크에 데이터를 저장하는 시스템 호출 발생
>2. 커널 모드로 전환
>3. OS 내 '하드 디스크에 데이터 저장' 코드 실행 
>4. 저장 후 다시 사용자 모드 복귀

일반적인 애플리케이션은 이 과정을 빈번하게 발생시키며 사용자모드와 커널 모드를 오간다.

## OS의 핵심 서비스 - (1) 프로세스 관리
프로세스 = 실행 중인 프로그램.

CPU는 하나의 프로세스만 실행할 수 있기 때문에, 여러 개의 프로세스가 돌아가며 조금씩 실행된다. 
<br>
다양한 프로세스의 작동 스케줄과 필요한 자원 등을 파악하여 관리하고 실행한다.

##### * 프로세스 동기화, 교착 상태 해결은 필수적인 업무이다.

## OS의 핵심 서비스 - (2) 자원 접근 및 할당
애플리케이션과 컴퓨터 자원 사이에서 문지기 역할을 하는 것이 OS이다. 주요 자원에는 CPU, 메모리, 입출력장치가 있다.

- CPU<br>
CPU는 한번에 하나의 프로세스만 실행할 수 있기 때문에, 프로세스에 CPU를 할당하는 순서와, 할당하는 시간을 결정해야 한다. 이를 CPU 스케줄링이라고 한다.


- 메모리<br>
프로세스마다 메모리에 적재된 크기, 주소가 다양하다. OS는 프로세스에 적절한 메모리 위치와 크기를 할당하고, 메모리가 부족할 경우에 대해서도 대비한다. (14장)

- 입출력장치<br>
입출력장치는 하드웨어 인터럽트를 발생시킨다. 입출력장치가 CPU에 하드웨어 인터럽트 요청 신호를 보내면 CPU는 하던 일을 잠시 백업한 뒤 커널 영역에 있는 인터럽트 서비스 루틴을 실행한다. 

## OS의 핵심 서비스 - (3) 파일 시스템 관리
여러 파일을 열고, 생성하고, 삭제학, 파일을 한데 묶어 디렉토리로 관리하는 OS 기능.


---
##### * 하이퍼바이저 모드
가상 머신을 지원하는 CPU는 **하이퍼바이저 모드**도 지원한다.

가상 머신에 설치된 OS 상에 설치된 응용 프로그램이 가상머신 OS의 서비스를 이용하기 위한 모드이다.
