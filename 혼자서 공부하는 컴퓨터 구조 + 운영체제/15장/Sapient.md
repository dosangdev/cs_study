# 15. 파일 시스템


## 15-1. 파일과 디렉터리
### 파일
 - 파일이란 하드 디스크나 ssd와 같은 보조기억장치에 저장된 관련 정보의 집합을 의미한다.
 - 파일에는 이름, 실행하기 위한 정보, 부가 정보(속성 or 메타 데이터)가 있다.
     - 파일 속성과 유형
        - 속성
            - 유형: 운영체제가 인지하는 파일의 종류, 확장자를 이용해 파일 유형을 알린다.
            - 크기: 파일의 현재 크기와 허용 가능한 최대 크기
            - 보호: 어떤 사용자가 해당 파일을 읽고, 쓰고, 실행할 수 있는지
            - 생성 날짜: 파일이 생성된 날짜
            - 마지막 접근 날짜: 파일에 마지막으로 접근한 날짜
            - 마지막 수정 날짜: 파일이 마지막으로 수정된 날짜
            - 생성자: 파일을 생성한 사용자
            - 소유자: 파일을 소유한 사용자
            - 위치: 파일의 보조기억장치상의 현재 위치
        - 유형
            - 실행 파일: 없는 경우, exe, com, bin
            - 목적 파일: obj, o
            - 소스 코드 파일: c, cpp, cc, java, asm, py
            - 워드 프로세서 파일: xml, rtf, doc, docx
            - 라이브러리 파일: lib, a, so, dll
            - 멀티미디어 파일: mpeg, mov, mp3, mp4, avi
            - 백업/보관 파일: rar, zip, tar
      - 파일 연산을 위한 시스템 호출: 파일을 다루기 위해 운영체제가 제공하는 파일 연산으로서 파일 생성, 삭제, 열기, 닫기, 읽기, 쓰기가 있다.


  ### 디렉터리
   - 파일을 일목 요연하게 관리하기 위해 이용하는 것. 윈도우 운영체제에서는 폴더라고 부른다.
   - 모든 파일이 하나의 디렉터리에 있는 구조를 1단계 디렉터리라고 하고, 여러 계층을 가진 디렉터리를 트리 구조 디렉터리라고 한다.
   - 트리 구조 디렉터리에서 최상위 디렉터리를 흔히 루트 디렉터리라고 하고 슬래시로 표현한다.
   - 디렉터리를 이용해 파일 위치, 파일 이름을 특정짓는 정보인 경로라는 개념이 생겼다.
      - 절대 경로와 상대 경로
          - 절대 경로: 루트 디렉터리에서 자기 자신까지 이르는 고유한 경로
          - 상대 경로: 현재 디렉터리부터 시작하는 경로
      - 디렉터리 연산을 위한 시스템 호출: 운영체제는 파일과 마찬가지로 디렉터리 연산을 위한 시스템 호출인 디렉터리 생성, 삭제, 열기, 닫기, 읽기를 제공한다.
      - 디렉터리 엔트리: 디렉터리에 담겨 있는 대상과 관련된 정보. 보통 테이블(표) 형태로 구성된다. 파일 시스템에 따라 다른 정보를 담고 있지만 디렉터리에 포함된 대상의 이름과 그 대상이 보조기억장치 내에 저장된 위치를 유추할 수 있는 정보는 공통으로 갖고있다.


<hr/>

## 15-2. 파일 시스템
### 파일과 디렉터리를 보조기억장치에 일목요연하게 저장하고 접근할 수 있게 하는 운영체제 내부 프로그램


### 파티셔닝과 포매팅
 - 파티셔닝: 저장 장치의 논리적인 영역을 구획하는 작업. 파티셔닝 잡을을 통해 나누어진 영역 하나하나를 파티션이라고 한다.
 - 포매팅: 파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할 것인지를 결정하고, 새로운 데이터를 쓸 준비를 하는 작업. 포매팅할 때 파일 시스템이 결정되고, 파티션마다 다른 파일 시스템을 설정할 수도 있다.

### 파일 할당 방법
 - 연속 할당
   - 보조기억장치 내 연속적인 블록에 파일을 할당하는 방식.
   - 연속으로 할당된 파일에 접근하기 위해서는 파일의 첫 번째 블록 주소와 블록 단위의 길이만 알면 되므로 디렉터리 엔트리에는 파일 이름과 첫 번째 블록 주소, 블록 단위의 길이를 적는다.
   - 구현이 단순하지만, 외부 단편화를 발생시킬 수 있다는 치명적인 문제가 있다.
 - 불연속 할당
   - 연결 할당
       - 각 블록 일부에 다음 블록의 주소를 저장하여 각 블록이 다음 블록을 가리키는 형태로 할당하는 방식
       - 연속 할당과 마찬가지로 디렉터리 엔트리에는 파일 이름, 첫 번째 블록 주소, 블록 단위의 길이를 명시한다.
       - 단점
         > 1. 반드시 파일의 첫 번째 블록부터 접근하여 하나씩 차례대로 읽어야 하므로 파일 내 임의의 위치에 접근하는 임의 접근 속도가 매우 느리다.
         > 2. 고장이나 오류로 인해 파일을 이루는 블록에 하나라도 문제가 발생하면 그 이후의 블록에 접근할 수 없다.
       - 연결 할당을 변형한 대표적인 파일 시스템인 FAT를 많이 사용한다.
   - 색인 할당
       - 파일의 모든 블록 주소를 색인 블록이라는 하나의 블록에 모아 관리하는 방식
       - 연결 할당과는 달리 임의의 위치에 접근하기 쉽다.
       - 디렉터리 엔트리에는 파일 이름과 색인 블록 주소를 명시한다.


### 파일 시스템 살펴보기
 - FAT 파일 시스템
    - 연결 할당의 단점을 보완한 파일 시스템
    - 각 블록에 포함된 다음 블록의 주소들을 한데 모아 테이블 형태로 관리하는 방식
    - USB 메모리, SD 카드와 같은 저용량 저장 장치용 파일 시스템으로 많이 이용되고 있다.
    - 하드디스크 파티션의 시작 부분에 있지만, 실행 도중 FAT가 메모리에 캐시될 수 있다. 이렇게 메모리에 적재된 채 실행되면 기존 연결 할당보다 다음 블록을 찾는 속도가 매우 빨라져 임의 접근에도 유리해진다.
    - FAT 파일 시스템의 디렉터리 엔트리에는 파일 속성과 관련한 다양한 정보들이 있다.
 - 유닉스 파일 시스템
    - 색인 할당 기반의 파일 시스템. 색인 블록을 i-node라고 한다.
    - i-node에는 파일 속성 정보와 열다섯 개의 블록 주소가 저장될 수 있다.
    - 파일의 크기가 열다섯 개 이상의 블록을 차지할 경우 다음과 같은 방법으로 해결한다.
          > 1. 블록 주소 중 열두 개에는 직접 블록(파일 데이터가 저장된 블록) 주소를 저장한다.
          > 2. 열두 개의 블록 주소로 파일의 모든 블록을 가리킬 수 없을 때 열세 번째 주소에 파일 데이터를 저장한 블록 주소가 저장된 블록인 단일 간접 블록의 주소를 저장한다.
          > 3. 그래도 부족하면 열네 번째 블록 주소에 단일 간접 블록들의 주소를 저장하는 이중 간접 블록 주소를 저장한다.
          > 4. 이래도 또 부족하다고 하면 열다섯 번째 블록에 이중 간접 블록 주소가 저장된 블록 주소를 저장한다. 이러면 웬만하면 된다.
      
 - 이 외에도 윈도우 운영체제에서 사용되는 NT 파일 시스템(NTFS), 리눅스 운영체제에서 사용되는 ext 파일 시스템 등도 있다.
