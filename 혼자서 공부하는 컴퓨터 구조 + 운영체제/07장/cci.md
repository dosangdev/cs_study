# 다양한 보조기억장치

보조기억장치 중 가장 대중적인 하드 디스크와 플래시 메모리에 대해서 알아보자

## 하드 디스크

하드디스크는 **자기적인 방식**으로 데이터를 저장하는 보조기억장치이다.

CD나 LP와 생긴 것도 비슷하고 작동원리도 비슷하다.

### 하드 디스크 구성

- 플래터 : 데이터가 저장되는 동그란 원판. 여러개가 쌓여있다.
- 스핀들 : 플래터를 회전시키는 구성 요소. 회전속도는 RPM으로 표현된다.
- 헤드 : 데이터를 읽고 쓰는 구성 요소. 바늘같이 생겼다.
- 디스크 암 : 헤드가 부착되어 있는 구성 요소

### 하드 디스크 특징

- CD나 LP보다 훨씬 많은 대용량을 저장해야 하므로 여러개의 플래터로 구성되어있다.
- 플래터 양면을 모두 사용할 수 있다. 양면을 사용하면 위 아래로 두 개의 헤드가 사용된다.

### 하드 디스크에 저장

- 트랙 : 플래터를 동심원으로 나눈 단위 (실제 트랙과 같은 모양이다.)
- 섹터 : 트랙을 피자조각처럼 조각별로 나눈 단위. 하드 디스크의 가장 작은 전송단위이다.
    - 일반적으로 하나당 512바이트 이지만, 하드 디스크에 따라 차이가 있다. 일부 하드 디스크는 4,096 바이트에 이르기도 한다.
- 실린더 : 여러겹의 플래터가 있을 때, 같은 위치에 있는 트랙을 하나로 모아 연결한 논리적 단위. 모으면 원통형 모양이 된다.
    - 연속된 정보는 보통 한 실린더에 기록되는데, 그 이유는 디스크 암을 움직이지 않고 바로 데이터에 접근할 수 있기 때문이다. (네 개의 섹터에 저장한다고 가정했을 시 첫번째 플래터 위, 아래 그 다음 플래터 위 아래 이런 식으로 되기 때문이다.)

### 하드 디스크가 데이터에 접근하는 시간 3가지

- 탐색 시간 : 접근하려는 데이터가 저장된 트랙까지 헤드가 이동하는 시간 (But 다중 헤드 디스크는 헤드가 각 트랙마다 있으므로 탐색 시간이 없다!)
- 회전 지연 : 헤드가 있는 곳으로 플래터를 회전시키는 시간
- 전송 시간 : 하드 디스크와 컴퓨터 간에 데이터를 전송하는 시간
- 제프 딘이 과거 ‘프로그래머가 꼭 알아야 할 컴퓨터 시간들’ 중에 탐색시간과 전송 시간이 있다.
- 속도를 높이기 위해서 탐색 시간과, 회전 지연도 중요하지만, 참조 지역성, 즉 접근하려는 데이터가 플래터 혹은 헤드를 조금만 옮겨도 접근할 수 있는 곳에 위치해 있는 것도 중요하다.

## 플래시 메모리

플래시 메모리는 **전기적**으로 데이터를 읽고 쓸 수 있는 **반도체 기반**의 저장 장치이다.

크게 NAND 플래시 메모리와 NOR 플래시 메모리가 있지만, 대용량 저장 장치로는 NAND가 많이 쓰인다.

### 셀과 셀에 따른 플래시 메모리 종류

- 셀 : 플래시 메모리에서 데이터를 저장하는 가장 작은 단위이다.
- 한 셀에 몇 비트를 저장할 수 있느냐에 따라 플래시 메모리 종류가 나뉜다.
    - SLC : 한 셀에 1비트를 저장 Single-Level Cell
    - MLC : 한 셀에 2비트를 저장 Multiple-Level Cell
    - TLC : 한 셀에 3비트를 저장 Triple-Level Cell
- 각 종류에 따라 수명, 속도, 가격에 꽤 많은 차이가 난다.

### SLC

- 한 셀로 두개의 정보를 표시할 수 있다. 0과 1
- 집 하나에 혼자 거주하는 것으로 비유할 수 있다.
- 그렇기에 데이터의 입출력이 MLC나 TLC보다 빠르다.
- 수명도 MLC와 TLC보다 길어서 수만에서 수십만 번 가까이 데이터를 쓰고 지우기 가능
- 하지만 SLC는 용량 대비 가격이 높다.

### MLC

- 한 셀로 네 개의 정보를 표시할 수 있다. 0 1 01 11
- 그래서 대용화하기 쉽다. 그리고 SLC 대비 용량 대비 가격이 싸다.
- 하지만 수명과 속도는 SLC보다 짧고 느리다.

### TLC

- 한 셀로 8개의 정보를 표시할 수 있다.
- 대용화하기 쉽다. SLC MLC 대비 용량 대비 가격이 싸다.
- 하지만 속도와 수명은 그 만큼 느리고 짧다.

### 셀 보다 큰 단위

- 페이지 : 셀들이 모여 만들어진 단위. 읽기와 쓰기를 할 때 기준이 되는 단위
- 블록 : 페이지가 모여 만들어진 단위. 삭제를 할 때 기준이 되는 단위
- 플레인 : 블록이 모여 만들어진 단위
- 다이 : 플레인이 모여 만들어진 단위

### 페이지

- 페이지는 세 개의 상태를 가질 수 있다.
    - Free : 어떠한 데이터도 없어서 새로 저장할 수 있음
    - Valid : 이미 유효한 데이터를 저장하고 있음.
    - InValid : 쓰레기값이라 부르는 유효하지 않은 데이터를 저장하고 있음
- 플래시 메모리는 하드 디스크와 달리 덮어쓰기가 불가능하여 Valid 상태인 페이지에는 새 데이터를 저장할 수 없다.

### 그림 참조

읽기/쓰기를 할 때와 삭제를 할 때의 기준이 다르기 때문에 생기는 문제를 가비지 컬렉션이라는 기능으로 해소한다.

유효한 페이지를 새 블록으로 이사시킨 후, 원래의 블록을 폐기하는 방법!

# RAID의 정의와 종류

1TB 하드 디스크 4개가 한 개의 4TB 하드 디스크 보다 빠르고 안전하다! 왜 이런 차이가 나는지 알아보자

## RAID의 정의

**RAID** : 데이터의 안정성 혹은 높은 성능을 위해 여러 개의 물리적 보조기억장치를 마치 하나의 논리적 보조기억장치처럼 사용하는 기술을 의미한다.

## RAID의 종류

RAID를 구성하는 방법을 RAID 레벨이라고 한다.

### RAID 0

- 여러 개의 보조기억장치에 데이터를 단순히 나누어 저장하는 구성 방식
- 이 때 차례로 줄무늬 처럼 분산되어 저장되는데 이를 본따 데이터는 Stripe, 그리고 그 방식을 Striping이라고 한다.
- A가 4개의 하드디스크에 1/4 크기로 저장된다.
- 하나의 하드디스크를 썼다면 A를 여러 번에 걸쳐 읽고 썼을 테지만 동시에 각 보조기억장치에서 데이터를 읽거나 쓰므로 이론상 4배가량 빠를 수 있다.
- 단점 : 안전하지 않다. 하나의 보조기억장치에 문제가 생기면 나머지 데이터도 무용지물이 될 가능성이 있다.

### RAID 1

- RAID 0을 보완하기 위해 나온 방식
- 복사본을 만드는 방식이다. 마치 거울처럼 완전한 복사본을 만들기 때문에 미러링이라고도 한다.
- 4개의 보조기억장치가 있다면 2개는 원본 나머지 2개에는 복사본을 저장한다.
- 똑같은 데이터를 2번 써야 하기 때문에 쓰기 속도는 RAID 0보다 느리다.
- 그렇지만 완전한 복사본이 있으므로 원본이 없어져도 복구를 빠르게 할 수 있다는 장점이 있다.
- 하지만 사용 가능한 용량이 적어지므로 비용이 많이 증가하게 된다.

### RAID 4

- 완전한 복사본을 만드는 대신 오류를 검출하고 복구하기 위한 정보 ‘패리티 비트’를 두는 방식
- 4개 중 3개에 데이터를 나눠서 저장하고 나머지 한 개에 패리티 정보를 둔다.
- 패리티를 저장한 장치를 이용해 다른 장치들의 오류를 검출하고, 오류가 있다면 복구한다.
- RAID4는 RAID1보다 적은 하드 디스크로도 데이터를 안전하게 보관할 수 있다.

### RAID 5

- RAID 4는 한 개의 장치에 패리티 정보를 몰아서 쓰게 되므로 패리티를 저장하는 장치에 병목 현상이 발생한다는 문제가 있다.
- 그래서 RAID 5는 패리티를 각 장치에 분산하여 저장하는 방식을 사용하여 그 문제를 해결하 였다.

### RAID 6

- 기본 구성 방식은 RAID 5와 같으나, 서로 다른 두 개의 패리티를 두는 방식이다.
- RAID 4나 RAID 5보다 안전한 방식.
- 하지만 새로운 정보를 저장할 때 저장해야 할 패리티가 2개이므로 RAID 5보다 쓰기 속도는 느리다.
- 데이터 저장 속도를 조금 희생하더라도 안전을 우선시하고 싶을 때 쓰는 방식