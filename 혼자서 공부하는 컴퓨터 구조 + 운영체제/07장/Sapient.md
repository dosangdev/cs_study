# 보조기억장치

## 07-1 다양한 보조기억장치

### 하드디스크

- 하드디스크는 자기적인 방식으로 데이터를 저장하는 보조기억장치이다.(하드디스크를 자기 디스크라고도 한다)
- 하드디스크의 구성 요소
    - 플래터: 하드 디스크에서 실질적으로 데이터가 저장되는 곳. 동그란 원판같이 생겼으며 자기 물질로 덮여 수많은 N극과 S극을 저장한다. N극과 S극은 0과 1의 역할을 수행한다
    - 스핀들: 플래터를 회전시키는 구성 요소. 스핀들이 플래터를 돌리는 속도는 RPM(Revolution Per Minute)으로 나타낸다.
    - 헤드: 플래터를 대상으로 데이터를 읽고 쓰는 구성 요소.
    - 디스크 암: 원하는 위치로 헤드를 이동시키는 디스크 암에 부착되어 있다.
- 하드 디스크는 일반적으로 여러 겹의 플래터로 이루어져 있고 플래터 양면을 모두 사용할 수 있다.
- 플래터에 데이터가 저장되는 방식
    - 플래터는 트랙과 섹터라는 단위로 데이터를 저장한다.
    - 플래터를 여러 동심원으로 나누었을 때 그 중 하나의 원을 트랙이라고 하고, 그 트랙은 여러 조각으로 나누어지는데 이 한 조각을 섹터라고 한다. 섹터의 크기는 하드 디스크에 따라 차이가 있다.
    - 여러 겹의 플래터 상에서 같은 트랙이 위치한 곳을 모아 연결한 논리적 단위를 실린더라고 부른다.
    - 연속된 정보는 디스크 암을 움직이지 않고도 바로 데이터에 접근할 수 있게하기 위하여 보통 한 실린더에 기록된다.
- 하드 디스크가 저장된 데이터에 접근하는 시간
    - 탐색 시간: 접근하려는 데이터가 저장된 트랙까지 헤드를 이동시키는 시간
    - 회전 지연: 헤드가 있는 곳을 플래터를 회전시키는 시간
    - 전송 시간: 하드 디스크와 컴퓨터 간에 데이터를 전송하는 시간
- 탐색 시간과 회전 지연을 단축시켜 성능을 향상 시키기 위해서는 플래터를 빨리 돌려 RPM을 증가 시키는 것도 중요하지만, 접근하려는 데이터가 플래터 혹은 헤드를 조금만 옮겨도 접근할 수 있는 곳(참조 지역성)에 위치해 있는 것도 중요하다.

### 플래시 메모리

- 우리가 흔히 사용하는 USB 메모리, SD 카드 SSD가 플래시 메모리 기반의 보조기억장치이다.
- 플래시 메모리는 전기적으로 데이터를 읽고 쓸 수 있는 반도체 기반의 저장 장치이다.
- 플래시 메모리는 주기억장치 중 하나인 ROM에서도 사용되고, 우리가 일상적으로 접하는 거의 모든 전자 제품안에 플래시 메모리가 내장되어 있다고 봐도 된다.
- 플래시 메모리에서 데이터를 저장하는 가장 작은 단위를 셀 이라고 한다.
- 이 때 하나의 셀에 몇 비트를 저장할 수 있느냐에 따라 플래시 메모리 종류가 나뉜다.

**플래시 메모리의 종류**

- SLC 타입
    - 한 셀에 1비트를 저장할 수 있는 플래시 메모리
    - 한 셀로 0과 1 두개의 정보를 표현할 수 있다.
    - 다른 타입에 비해 비트의 빠른 입출력이 가능하고 수명도 길지만 용량 대비 가격이 높다.
    - 보통 기업에서 데이터를 읽고 쓰기가 매우 많이 반복되며 고성능의 빠른 저장 장치가 필요한 경우에 SLC 타입을 사용한다.
- MLC 타입
    - 한 셀로 네 개의 정보를 표현한 수 있다
    - SLC 타입에 비해 속도와 수명은 떨어지지만, 하나의 셀에 두 비트씩 저장할 수 있다는 점에서 대용화하기 유리하고 용량 대비 가격이 저렴하다.
    - 시중에서 사용되는 많은 플래시 메모리 저장 장치들이 MLC 타입(또는 TLC)이다.
- TLC 타입
    - 한 셀당 3비트를 저장할 수 있는 플래시 메모리이며 한 셀로 8개의 정보를  표현할 수 있다. 따라서 대용화 하기 유리하다.
    - MLC 타입이나 SLC 타입에 비해 수명과 속도가 떨어지지만 용량 대비 가격이 저렴하다.

- 셀들이 모여 만들어진 단위를 페이지, 페이지가 모여 만들어진 단위를 블록, 블록이 모여 플레인, 플레인이 모여 다이가 된다.
- 플래시 메모리에서 읽기와 쓰기는 페이지 단위로 이루어지고, 삭제는 블록 단위로 이루어진다.
- 페이지가 가지는 상태
    - Free 상태: 데이터를 저장하고 있지 않아, 데이터를 저장할 수 있는 상태
    - Valid 상태: 이미 유효한 값을 저장하고 있는 상태
    - Invalid 상태: 쓰레기값이라 부르는 유효하지 않은 데이터를 저장하고 있는 상태
- 플래시 메모리는 덮어쓰기가 불가능하여 Valid 상태인 페이지에는 새 데이터를 저장할 수 없다.
- Invalid 상태의 쓰레기값을 저장하고 있는 공간은 사용하지 않을 공간임에도 용량을 차지하고있어 낭비가 발생하는데 삭제는 블록 단위로 이루어지기 때문에 페이지만 따로 삭제할 수도 없다. 이 문제를 해결하기 위해 최근의 플래시 메모리에는 가비지 컬렉션 기능을 사용하여 용량 낭비를 방지한다.

**가비지 컬렉션의 동작 방식**

1. 유효한 페이지들만을 새로운 블록으로 복사한 뒤
2. 기존의 Invalid 상태 페이지가 포함된 블록을 삭제한다.

## 07-2 RAID의 정의와 종류

### RAID의 정의

- RAID란 주로 하드 디스크와 SSD를 사용하는 기술로, 데이터의 안전성 혹은 높은 성능을 위해 여러 개의 물리적 보조기억장치를 마치 하나의 논리적 보조기억장치처럼 사용하는 기술을 말한다.

### RAID의 종류

RAID 구성 방법을 RAID 레벨이라고 표현한다.

- RAID 0
    - 여러 개의 보조기억장치에 데이터를 단순히 나누어 저장하는 구성 방식
    - 저장되는 데이터가 하드 디스크의 갯수만큼 나뉘어 저장된다.
    - 데이터가 분산되어 저장되면 저장된 데이터를 읽고 쓰는 속도가 빨라지지만, 하드 디스크 중 하나에 문제가 생긴다면 다른 모든 하드 디스크의 정보를 읽는데 문제가 생길 수 있어 저장된 정보가 안전하지 않다는 단점이 있다.
- RAID 1
    - 복사본을 만드는 방식이며 미러링이라고도 한다.
    - 데이터를 쓸 때 원본과 복사본 두 군데에 쓰기 때문에 RAID 0 보다 쓰기 속도는 느리지만 복사본이 있기 때문에 하나에 문제가 발생해도 복구가 매우 간단하다.
    - 디스크 개수가 한정되었을 때 복사본이 만들어지는 만큼 사용 가능한 용량이 적어지고 그로인해 많은 양의 하드 디스크가 필요하게 되어 비용이 증가한다는 단점이 있다.
- RAID 4
    - 오류를 검출하고 복구하기 위한 정보(패리티 비트)를 저장한 저장 장치를 두는 구성 방식
    - 패리티를 저장한 장치를 이용해 다른 장치들의 오류를 검출하고, 오류가 있다면 복구한다.
    - RAID 1 보다 적은 하드 디스크를 이용해 데이터를 안전하게 보관할 수 있다.
- RAID 5
    - RAID 4에서는 새로운 데이터가 저장될 때마다 패리티를 저장하는 디스크에도 데이터를 쓰게되므로 패리티를 저장하는 장치에 병목 현상이 발생할 수 있다.
    - RAID 5에서는 RAID 4의 문제인 병목 현상을 해결하기 위해 패리티 정보를 하나의 하드 디스크가 아닌 각각의 하드 디스크에 분산하여 저장한다.
- RAID 6
    - 기본적인 구성은 RAID 5와 같으나 서로 다른 두 개의 패리티를 두는 방식이다.
    - 새로운 정보를 저장할 때마다 함께 저장할 패리티가 두 개이므로, 쓰기 속도는 RAID 5보다는 느리지만 오류를 검출하고 복구할 수 있는 수단이 두 개가 생긴 셈이므로 RAID 4,  RAID 5보다 안전한 구성이다.
    - 저장 속도를 조금 희생하더라도 데이터를 안전하게 보관하고 싶을 때 사용한다.

각 RAID 마다 장단점이 있으므로 어떤 상황에서 무엇을 최우선으로 원하는지에 따라 최적의 RAID 레벨은 달라질 수 있으므로, 각 RAID의 구성과 특징을 아는 것이 중요하다.
