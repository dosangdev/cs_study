2장. 데이터를 주고받는 원리
-----------------

### 05. 프로토콜

#### - 프로토콜의 개념
> 네트워크 상에서 통신할 데이터의 구성이나 주고 받는 절차 등이 정의되어 있는 통신 규약, 규칙, 약속 

우리가 택배를 보낼 때 택배 송장에 여러 정보를 써서 보낸다. - 출발지, 도착지, 내용물, 소포 종류(특급...)

이 때 택배사마다 이 송장을 쓰는 양식, 이 택배가 목적지까지 도착하는 방법(선박, 트럭, 비행기...)은 다양할 수 있다. 이것들을 프로토콜로 비유할 수 있다.

프로토콜은 수많은 종류가 있고, 두 기기가 같은 프로토콜을 사용해야 통신할 수 있다. 국제 표준은 ISO, IEEE 등의 표준화 단체에서 규정하고 있다.


#### - 종류
|프로토콜|용도|사용하는 곳|
|-|-|-|
|IEEE 802.3|IEEE가 규정하는 이더넷 규격의 프로토콜|LAN 케이블|
|IEEE 302.11|IEEE가 규정하는 무선 LAN 규격의 프로토콜|Wi-Fi|
|IP|여러 네트워크를 구성하는 프로토콜|인터넷|
|TPC|신뢰성을 높인 프로토콜|인터넷|
|UDP|속도와 편의성을 우선으로 하는 프로토콜|인터넷|
|HTTP|웹 브라우저와 서버 간 통신 프로토콜|웹|

### 06. 네트워크 계층
#### - 네트워크를 계층으로 나누는 이유
한 컴퓨터에서 다른 컴퓨터로 데이터를 보내는 과정에서 사용되는 프로토콜이 매우 다양하고, 많다.

많은 프로토콜을 한 애플리케이션에서 모두 처리하는 것은 비효율적 -> 단계별로 계층을 나누어 분담한다.


#### - 프로토콜 스택
스택 : 상자를 쌓듯이, 쌓아올리는 구조

네트워크 계층 별로 프로토콜이 스택처럼 쌓이게 된다. 용도 별로 프로토콜의 종류는 다양하고, 각 계층 별로 사용하는 프로토콜이 다르다. 

#### - 프로토콜 구조

> 데이터 단위의 기본 구조 : 헤더 + 페이로드

페이로드는 데이터, 헤더는 프로토콜이 추가한 주소 등의 정보가 들어간다.

상위 계층의 헤더 + 페이로드 = 하위 계층의 페이로드

![image](https://github.com/Minnie5382/devduck-cs-study/assets/97179789/944e97d0-8fab-438e-bf06-03294f0a740d)

데이터를 보낼 때는 7계층 -> 1계층으로 이동 (캡슐화)

데이터를 받을 때는 1계층 -> 7계층으로 이동 (역캡슐화)



각 계층을 거치며 겹겹이 쌓이는 구조, 마치 상자 안의 상자처럼 (스택)



### 07. 네트워크 모델
#### - OSI 참조 모델과 TCP/IP 모델
>OSI 참조 모델 : 1970년대 국제표준화기구 ISO에서 규정한 네트워크 모델의 표준
>
>TCP/IP 모델 : OSI 참고 모델을 기반으로 좀 더 간소화된 네트워크 모델. 인터넷에서 사용된다.

![image](https://github.com/Minnie5382/devduck-cs-study/assets/97179789/eadd6148-3000-4827-8e1b-97773094910c)
|계층|명칭|주요 프로토콜|
|-|-|-|
|7계층|애플리케이션 계층|HTTP, DNS, FTP|
|6계층|표현 계층|SMTP, FTP|
|5계층|세션 계층|TLS|
|4계층|전송 계층|TCP, UDT|
|3계층|네트워크 계층|IP|
|2계층|데이터 링크 계층|IEEE 802.3(이더넷), IEEE802.11(무선랜)|
|1계층|물리 계층|광섬유|



### 08. TCP/IP
#### - IP, TCP, UDP
IP와 TCP와 UDP는 모두 프로토콜의 종류이다. 근데 셋의 관계가 긴밀하여 같이 다니는 경우가 많고, 그냥 묶어서 부르기도 함.

>IP(Internet Protocol) : 컴퓨터마다 고유한 IP 주소를 할당하고 이 IP 주소를 통해 통신하는 프로토콜 (인터넷 계층에서 사용)

IP는 현재도 널리 쓰이지만, 본래 단점이 많다.(비연결성, 비신뢰성, 앱 구분 불가) 그래서 이를 보완하기 위해 있는 것이 TCP이다.

> TCP : IP 프로토콜이 정의하지 않는 시퀀스 번호(패킷 번호), 응답 확인 번호(자기 다음에 와야되는 패킷 번호), 세션 플래그(세션의 상태), 포트 번호 등 통신의 안정성을 위한 것들을 정의하는 프로토콜. (전송 계층에서 사용)
> 
> UDP : TCP처럼 IP 프로토콜을 보완하는 프로토콜이지만, 포트 번호 정도만 포함하고 있어 더 빠르고 편리하다.(전송 계층에서 사용)

###### 현재 대부분의 인터넷 통신이 IP와 TCP 조합으로 이루어지며, 이를 한데 묶어서 TCP/IP 프로토콜이라고 한다. 그리고 앞서 배웠던 TCP/IP 네트워크 모델도 TCP/IP 프로토콜을 중심으로 구축되었기 때문에 그런 이름이 붙여졌다.

### 09 & 10. IP 주소
#### - IPv4/IPv6

TCP/IP 프로토콜을 사용하는 인터넷에서는 컴퓨터의 기본적인 주소로 IP 주소를 사용한다. IANA에서 관리한다.
버전은 IPv4와 IPv6 두 가지가 있는데, 서로 호환은 되지 않고 현재는 혼용하여 사용한다.

IPv4는 아래 그림처럼 구성되어 있다.

<img width="484" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/e71283ca-3aff-4d2e-9853-1d4a46336511">

네트워크에서는 8 bits = 1 byte 단위를 옥텟이라고 한다.

IPv4는 32 bits = 2의 8제곱 = 약 43억개의 주소를 사용할 수 있다. 

그러나 인터넷이 확장됨에 따라 이 숫자가 부족해져서 더 큰 숫자의 주소를 표현할 수 있는 IPv6가 고안되었다. IPv6는 128 bits로 구성되어 있어 거의 무한정에 가까운 주소를 표현할 수 있다.

아직 IPv6의 보급이 완료되지 않아 현재 대부분의 웹 서비스는 IPv4를 기반으로 작동중이다.
<br><br><br>
뿐만 아니라 IPv6는 
- 헤더가 단순하여 처리가 쉽다.
- 프로토콘 단계에서 암호화가 가능.
- 계층 구조가 엄격하여 라우팅 효율 좋음.
- MAC 주소로 IPv6를 자동 생성할 수 있다.

<br>

#### - 글로벌 IP/프라이빗 IP
각 LAN은 라우터에 연결되어 있고 이 라우터는 전 세계 네트워크인 인터넷에 연결되어 있다. 
>글로벌 IP : 인터넷에 직접 연결되어 있는 라우터 등의 게이트웨이가 갖는 IP 주소. 인터넷에서 사용. 인터넷 내에서 유일함
>
>프라이빗 IP : LAN 내부에서 디바이스들이 사용하는 IP 주소. LAN 내부에서만 사용. LAN 내에서 유일함

<img width="441" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/e0dcf49f-2f2e-42ca-a59e-91c50f5f46ee">


### 11. MAC 주소
#### - 구조

![image](https://github.com/Minnie5382/devduck-cs-study/assets/97179789/becf95ea-d4e8-48c2-a550-271a159ff771)

제조사 번호는 벤더 코드라고도 한다. 벤더 코드만 해도 140조 개이고, 하나의 벤더 코드로 140조 개의 MAC 주소를 만들 수 있다.

IEEE에서 제조사마다 벤더 코드를 하나씩 부여해주는데, 자회사 등이 있는 대기업은 벤더 코드를 여러 개 가질 수 있다.

MAC 주소는 원래 변경할 수 없는 정보지만, 최근엔 보안을 이유로 랜덤 MAC 주소를 사용하도록 설정할 수 있다.


#### - IP 주소 vs MAC 주소
|구분|MAC|IP|
|-|-|-|
|프로토콜|이더넷(2계층 이하)|TCP/IP(3계층 이상)|
|식별 대상|디바이스(단말기)|네트워크 호스트|
|식별자 수|280조 개|43억 개|
|관리 단체|IANA|IEEE|


### 12. ARP
#### - ARP란?
통신을 하기 위해서는 IP 주소 뿐만아니라 MAC 주소도 필요하다.
IP 주소는 논리적인 주소여서, 라우팅(경로 설정) 시 사용되고 실질적으로 데이터를 토스할 때는 MAC 주소를 이용해 보내기 때문이다. 

하지만 그렇다고 IP 주소 없이 MAC 주소만으로는 통신이 될 수 없다. MAC은 하드웨어 기기의 고유 번호이기 때문에 물리적인 주소인데, 이는 라우팅이 어렵다.

이렇게 IP 주소를 이용하여 MAC 주소를 알아낼 때 사용하는 프로토콜이 ARP(Address Resolution Protocol)이다.


#### - ARP 작동 방식

![image](https://github.com/Minnie5382/devduck-cs-study/assets/97179789/e603abfc-4ec5-42fa-9811-8dfd010aebb7)

LAN 내의 모든 장치에게 패킷을 전송하는 것은 브로드캐스트 라고 한다. 즉 이 패킷은 모든 장치가 수신하게 된다.

MAC 주소를 알고싶은 IP 주소가 들어있는 패킷을 브로드캐스트하면, 해당하는 장치가 '그거 나야, 내 MAC 주소 XX-XX 야.' 라고 알려준다.

실제로는 매 통신마다 ARP를 통해 조회하진 않고, 게이트웨이(라우터)가 IP주소-MAC주소 표를 만들어두고, 필요할 때는 라우터에게 문의해서 MAC 주소를 확인한다. 

###### 게이트웨이는 관리자 역할을 하는 기기로, LAN 내의 기기들이 본인이 모르는 정보를 문의하기도 하고 LAN 외부와의 통신도 담당한다. 각 장치들은 모두 이러한 '게이트웨이'라는 개념을 갖고 있기 때문에 게이트웨이 기기의 IP 주소를 미리 설정해둔다.


### 13. 포트 번호
#### - 포트 번호란
기기의 소프트웨어 상에서 돌아가는 애플리케이션을 특정하기 위해 애플리케이션마다 하나씩 할당받는 번호.
TCP/UDP 헤더의 상위 16 bits에 해당하고 16 bits이므로 0~65535 범위의 숫자를 표현할 수 있다. 

>'Hello'라는 메시지를 받았는데, 채팅 앱으로 온건지 배달 앱으로 온건지 알 수가 없어!

이런 불상사를 막기 위해 TCP/UDP가 어떤 앱에서 왔고(출발지 포트 번호), 어떤 앱으로 가야하는지(도착지 포트 번호)를 헤더에 추가해놓는 것이다.


#### - 잘 알려진 포트(well-known port)
0~1023 범위의 포트는 잘 알려진 포트라고 하고, 주요 애플리케이션(HTTP, DNS, FTP 등) 에 할당한다.

![image](https://github.com/Minnie5382/devduck-cs-study/assets/97179789/4757b922-6b86-4d18-a0ad-b0887c0d450e)
###### 서버 개발자로 일하다보면 자주 접하게 될 포트들이니 기억해두자.


### 14. 회선 교환 방식
#### - 유선 전화
모든 전화기를 서로 선으로 연결하기란 쉽지 않기 때문에, LAN의 허브처럼 중간에 교환대를 두어 모든 전화기를 교환대에 연결한다. 

교환대로 전화를 걸면 교환원이 이를 받아서 연결을 원하는 상대를 확인한 후, 전화를 연결해주는 방식. 교환대끼리 이어주는 상위 교환대도 있어서, 이런식으로 해외까지 커버할 수 있음.

이런 통신 방식을 회선 교환 방식이라고 한다.

회선 교환 방식은 일대일 연결을 생성하므로 한 통화 당 한 회선을 독점하는데, 이 방식은 통화량이 많아지면 비효율적이다. 따라서 현재는 회선을 다중화하고 통신은 디지털화 하여 효율을 높였다. 기본 원리는 회선 교환 방식과 동일하다.

### 15. 패킷 교환 방식
#### - 패킷 교환 방식의 원리와 장점
>회선 교환 방식: 한 통신이 끝날 때까지 한 회선을 독점하는 형태.
>
>패킷 교환 방식: 데이터를 여러 개의 패킷으로 쪼개서 패킷들을 회선에 실어 보내는 형식.

패킷 교환 방식은 매번 회선을 연결할 필요가 없어 아무때나 데이터를 보낼 수 있고, 동시에 여러 개의 데이터를 보낼 수 있다.

그러나 한 데이터를 패킷으로 쪼갠 만큼, 패킷 내에 원본 데이터와 패킷에 대한 관리 정보를 자세히 명시해놔야 한다. 안 그러면 패킷을 잃어버리거나 순서가 꼬일 수 있다.

#### - 패킷이 만들어지는 이야기

<img width="800" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/03bcad1e-f5da-4d9c-b904-b7e465d8eac4">

>(이후 설명은 TCP/IP 5계층 기준입니다)
>
>앞서 상위 계층에서 하위 계층으로 내려갈수록 헤더가 붙고, 이를 캡슐화라고 배웠었다.
>
>네트워크 계층을 크게 애플리케이션/시스템으로 나눴을 때, 애플리케이션 단에서 시스템 단으로 데이터를 내려보낼 때 소켓이 필요하다.
>소켓은 쉽게 말해 TCP, UDP 등의 프로토콜이라고 생각하면 된다. 
>응용 계층에서 내려온 데이터가 L4에서 TCP/UDP를 만나면 일정 단위로 분할되고(segmentation), 우리가 알던 것처럼 TCP/UDP 헤더가 붙게 된다. dl 헤더가 붙은 세그먼트 조각들은 또 L3로 내려가서 IP 프로토콜을 만나 IP 헤더가 붙는데 이걸 패킷(packet)이라고 한다. 이 패킷은 L2로 내려가 이더넷 프로토콜을 만나 또 이더넷 헤더가 붙어서 '프레임'이 된다.


#### - 패킷의 구조

<img width="450" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/2b27a0b9-be33-4ae8-a3dc-2628a504c3ae">

![image](https://github.com/Minnie5382/devduck-cs-study/assets/97179789/fb6323b8-72d9-4100-ae4d-ab77e07483d8)


### 16. 라우터
#### - 라우터의 기능
라우터는 LAN과 LAN을 연결하고, 패킷의 이동 결로를 그리고, 그린 경로에 따라 패킷을 토스한다. (라우팅)

앞서 배웠듯이 라우터는 내 LAN으로 온 패킷은 내가 취하고, 아닌 패킷은 인접한(이웃한, 직접 연결된) 라우터로 토스한다.

그래서 라우터는 본인의 LAN과 연결하는 LAN 포트와 다른 라우터와 연결하는 WAN 포트가 둘 다 있다.

이런 내부 LAN과 외부 인터넷의 경계에 설치하는 라우터를 에지 라우터라고 한다. = 게이트웨이


### 17. 엑세스 포인트
#### - 엑세스 포인트 = 무선 LAN의 허브 = Wi-Fi
지금까지 유선을 가정하고 네트워크를 설명했는데, 여기서 나오는 허브의 개념이 무선 LAN에서는 엑세스 포인트이다. 

IEEE 802.11 규격 중 무선 LAN 규격(Wi-Fi)을 사용한다.

시중에 나와있는 대부분의 Wi-Fi 장치는 대부분 라우터(3L) + 엑세스 포인트(2L) 기능을 통합한 기기이다.

#### - 인프라스트럭처 모드, 애드혹 모드
>일반적으로 액세스 포인트를 이용해 연결하는 형태 : 인프라스트럭처 모드
>
>엑세스 포인트 없이 장치끼리 직접 무선 링크하는 형태 : 애드혹(Ad-hoc) 모드
>
>애드혹: 임시로 만든


### 18. 허브
원래는 순수하게 집선 기능만 하는 장치였지만, 최근의 허브는 리피터(신호 증폭)의 역할도 한다. 

허브는 허브와 허브를 연결하는 캐스케이드 연결이 가능하다. 포트 중 하나를 다른 허브에 연결하면 된다.

### 19. 스위치(스위칭 허브)
#### - 스위치의 기능과 특징
>스위치(스위칭 허브) = 허브 + 연결 대상 전환 기능

현재 허브라고 하면 이 스위치를 일컫는다. 

스위치의 포트 수는 24개나 48개가 일반적이고 L2와 L3에서 둘 다 사용한다. 

스위치의 기능은 
- 집선 기능 : 허브의 기능
- 연결 대상을 전환하고 : 집선하고 있는 컴퓨터를 대상을 바꿔가며 서로 연결
- 가상의 세그먼트 분할 : 동일한 LAN 내에서 가상의 세그먼트(VLAN)을 분할할 수 있다. VLAN은 LAN과 동일하게 작동한다.

### 20. 케이블
#### - 직렬 vs 졍렬
앞서 직렬 통신과 병렬 통신을 배웠다. 직렬 케이블은 직렬 통신이 사용하고, 병렬 케이블은 병렬 통신에 사용된다. 병렬 케이블은 오래된 프린터 등에서 볼 수 있다.

#### - 케이블 규격
|케이블 규격|사용하는 곳|
|-|-|
|RS-232C (EIA-232D)|서버 렉이나 라우터, 스위치에 콘솔 연결
|이더넷 (IEEE 802.3 시리즈)|버스형 이더넷의 동축 테이블: 10BASE5, 10BASE2<br>스타형 이더넥의 트위스트 페어 케이블: 100BASE-T, 1000BASE-TX|
|광섬유 케이블 (ANSI/TIA-568.3-D)|데이터 통신|

<img width="200" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/65d62363-d769-4417-9c6a-368a11bbc5ef">
<img width="200" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/948efba8-9b38-4d7d-ad2d-fb4afbb3a097">


#### - 광 케이블 유형
>광섬유 케이블: 빛이 투과하는 유리 섬유를 튜브가 감싸고 있는 구조의 케이블.
>
>유리 섬유는 구부러져도 통신이 가능. 대역폭이 높고 장거리 통신에 적합.
>
>자세한 설명은 생략한다.

<img width="413" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/75e26e67-679c-477a-936c-b5fa6ee41a51">

### 21. 커넥터
#### - D-sub
RS232C 케이블에 이용되는 커넥터. 선호선 25개 중 9개를 연결하는 9핀 커넥터.

#### - RJ-45
이더넷 케이블에 이용되는 커넥터. 8핀.

#### - 광섬유 커넥터
광섬유에 이용되는 커넥트의 종류는 매우 다양하다 (SC, LS, 듀얼 SC, 듀얼 LC, FC ...)
광 신호를 전기 신호로 변환하는 기능을 탑재하고 있고 이 기능은 SFP 트랜시버가 한다.

#### - USB(Universal Serial Bus)
충전 뿐만아니라 데이터 전송용 선도 포함하고 있다.

<img width="300" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/d44e5118-b454-4519-aeec-ee255e683572">

<br>
<img width="700" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/d7be269e-d8c7-42ef-82e1-8bd565ce3288">


### 22. DHCP
#### - DHCP 프로토콜
> DHCP 프로토콜: LAN 내의 각 장치들에게 IP 주소를 자동으로 할당하는 프로토콜. 서버-클라이언트 형 프로토콜.
이 작업은 일반적으로 라우터나 기본 게이트웨이가 수행한다.

> Q. 서버-클라이언트 형 프로토콜이 뭐임?
>
> A. 두 기기가 있고, 한 기기는 서버, 다른 한 기기는 클라이언트가 된다. 클라이언트 기기는 서버 기기에게 작업을 요청하고, 서버 기기는 요청에 대한 응답을 준다.
> 이런 형태로 동작하는 프로토콜을 클라이언트-서버 형 프로토콜이라고 한다.

DHCP 서버는 클라이언트 기기의 요청에 따라 적절한 IP 주소를 할당한다. 라우터, 리눅스, 윈도 등에 준비되어 있다.

DHCP 클라이언트는 윈도, macOS, 리눅스, 안드로이드, iOS 등에 설치되어 있다.

#### - IP 주소 자동 할당하는 절차
![image](https://github.com/Minnie5382/devduck-cs-study/assets/97179789/748d2264-343c-4751-a339-292eaeb1e113)

>#### 요약
>
>클라이언트 : DHCP 서버 어딨음? (브로드캐스트)
>
>서버 : 나 여깄음 (응답)
>
>클라이언트 : IP 주소 좀 (요청)
>
>서버 : ㅇㅇ 여기 (응답)

### 23.NAT/NAPT
> NAT/NAPT : 프라이빗 IP 주소를 글로벌 IP 주소로 변환해주는 기능. 공유기에서 담당한다.

#### - NAT vs NAPT
>#### * NAT
>프라이빗 IP 주소 : 글로벌 IP 주소 로 1:1 대응변환표를 작성하고, 이 대응변환표에 맞춰서 IP 주소를 변환. 
>#### * NAPT
>NAT에서는 장치 수가 많아지면 동시에 인터넷에 연결할 수가 없다. 그래서 각 기기 별로 글로벌 IP 주소를 할당하는 게 아니라, 각 기기를 글로벌 IP 주소를 가진 기기의 포트라고 생각하여 IP 주소를 변환한다.
>
>예를 들어:
>
>디바이스 A의 웹 브라우저가 내부에서 192.168.1.2:80을 사용한다고 가정합니다.
>
>디바이스 B의 웹 브라우저가 내부에서 192.168.1.3:80을 사용한다고 가정합니다.
>
><br>
>NAPT가 이를 변환할 때:
>
>디바이스 A의 트래픽은 외부에서 공인 IP 주소로 나가면서, 예를 들어 203.0.113.1:5001로 변환될 수 있습니다.
>
>디바이스 B의 트래픽은 외부에서 공인 IP 주소로 나가면서, 예를 들어 203.0.113.1:5002로 변환될 수 있습니다.
>
>이렇게 함으로써 글로벌 IP 주소를 절약할 수 있다.


### 24. 라우팅 프로토콜
#### - IGP/EGP
>- IGP(Interior Gateway Protocol)
>  
>동일한 관리 정책의 라우터끼리 경로를 제어하는 프로토콜 (AS 내부), 즉 동일 그룹 내의 라우터끼리 정보를 주고받는 프로토콜
>
>- EGP(Exterior Gateway Protocol)
>  
>AS 간 라우팅 정보를 주고받는 프로토콜, 즉 다른 그룹 간의 라우터끼리 정보를 주고받는 프로토콜
<img width="605" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/96cb5fba-054c-4c6d-a237-97461b1056b8">

#### - IGP 알고리즘
1. 거리 벡터 형 : 라우터 간 거리, 방향 정보만으로 라우팅
2. 링크 스테이트 형 : 거리 벡터 뿐만아니라 네트워크 전체 토폴리지 정보를 수집하고, 각 라우터 간의 홉 수, 연결 상태 등을 상세히 파악하여 라우팅
3. 하이브리드 형: 두 가지 특징을 모두 갖는 방식
   
#### - EPG 알고리즘
1. 거리 벡터형
2. 경로 벡터형 : 거리 벡터형과 유사한데, 목적지까지의 경로 그 자체를 이용하여 라우팅하는 방식
   
<img width="871" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/8b8003ea-8a25-40cf-bd19-31996a0de843">

### 25. 기본 게이트웨이
>기본 게이트웨이 = LAN의 매니저. 라우터 중 관리자 라우터.

사무실에 무슨 일이 있으면 일단 팀장님을 부르는 것 처럼, 각 라우터들은 무슨 일이 있으면 기본 게이트웨이인 라우터에게 물어본다.

일하면서 물어봐야 하기 때문에, 모든 라우터는 기본 게이트웨이인 라우터의 IP 주소를 알고 있다.

#### - 게이트웨이의 업무
라우터는 인접한 라우터들의 정보를 담고 있는 '라우팅 테이블'을 갖고 일을 하는데, 자신이 관리하는 LAN으로 온 패킷이 아니라면 라우팅 테이블을 참고해 적절한 라우터로 토스를 한다.

근데, 내 LAN으로 온 것도 아니고, 라우팅 테이블에도 없는 미지의 IP 주소를 가진 패킷이 오면... 자기가 처리할 수 없기 때문에, 본인에게 설정되어 있는 기본 게이트웨이한테 일단 던진다.

기본 게이트웨이는 또 기본 게이트웨이를 갖고 있어서, 자기가 처리할 수 없을 때는 똑같이 자기에게 설정된 기본 게이트웨이로 던진다.


### 26. 서브넷
#### - CIRD (Classless Inter Domain Routing)
IP 주소의 영역을 여러 개의 사설망으로 나누기 위해 IP를 묶는 방식.
```
CIDR 주소는 가변 길이 서브넷 마스킹(VLSM)을 사용하여 IP 주소의 네트워크와 호스트 주소 비트 간의 비율을 변경합니다.
서브넷 마스크는 호스트 주소를 0으로 변환하여 IP 주소의 네트워크 주소 값을 반환하는 식별자 집합입니다. 

네트워크 관리자는 VLSM 시퀀스를 통해 IP 주소 공간을 다양한 크기의 서브넷으로 나눌 수 있습니다.
각 서브넷은 유연한 수의 호스트와 제한된 수의 IP 주소를 포함할 수 있습니다.
CIDR IP 주소는 네트워크 주소 접두사 비트 수를 나타내는 접미사 값을 일반 IP 주소에 추가합니다.

예를 들어 192.0.2.0/24는 처음 24비트 또는 192.0.2가 네트워크 주소인 IPv4 CIDR 주소입니다.
- AWS docs
```
-> 무슨 말이냐면

IP 주소 중에 아무 곳에서 잘라서, 상위 비트는 네트워크부, 하위 비트는 호스트부로 나눈다.
네트워크부에 해당하는 주소는 한 네트워크에서 고정이고, 호스트부는 일정 범위 내에서 각 기기들이 나눠서 가진다.

#### - 서브넷 마스크의 표기

이런 식으로 IP 주소를 네트워크부 별로 나눈 네트워크를 서브넷이라고 한다. 

그리고 네트워크부 영역의 비트를 모두 1, 호스트부 영역의 비트를 모두 0으로 표현한 주소 표기가 서브넷 마스크이다. (ex. 255.255.255.0)

즉 서브넷 마스크는 네트워크부와 호스트부의 자리를 표시해놓은 표기이다. 

서브넷 IP 주소의 프리픽스 표기는 다음과 같다.

<img width="232" alt="image" src="https://github.com/Minnie5382/devduck-cs-study/assets/97179789/adb4833c-35b0-4e14-825a-91ffacecbec6">

---

##### 추가로 공부할 것

- 기본 게이트웨이의 패킷 처리 방식
- TCP 3/4-way handshake
