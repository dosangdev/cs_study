# 보안 구조를 알아보자

## 73. 보안의 기본과 개념
### 정보 보안은 모든 분야에서 필수적인 요소이다. 특히 현재 컴퓨터는 네트워크에 연결해서 이용하는 것이 전제되므로 정보 보안은 네트워크 보안이라고도 할 수 있다.
### 정보 보안의 요소
> 1. 기밀성: 적법한 사람만 정보를 이용할 수 있도록 보호 및 관리되는 것
> 2. 무결성: 변경이나 파괴없이 종보가 올바른 상태로 유지되는 것
> 3. 가용성: 올바른 정보들이 적절하게 이용 가능한 상태에 있는 것
#### 기밀성과 무결성은 가용성과 상충하는 경향이 있다. 기밀성과 무결성을 높일수록 정보를 이용하거나 변경할 때 제한이 강화되어 가용성이 떨어진다.
#### 정보 보안에서는 보호할 정보 자산을 구체적으로 결정한다. 그 다음으로 그 정보 자산이 가지는 위험과 위협을 파악하고 위협에 대해 어떻게 대응할지 검토한다.


## 74. 멀웨어/컴퓨터 바이러스
#### IPA 정의에 따르면 컴퓨터 바이러스는 자기 전염 기능, 잠복 기능, 발병 기능을 가진다고 되어 있다. 예전에는 컴퓨터에 위해를 가하는 모든 것을 가리켰지만, 자기 전염 기능이나 잠복 기능 등이 명확하지 않고 침입이나 공격만 하거나 더 복잡한 동작을 하는 악성 코드 등이 증가하고 있다. 그러므로 현재는 악의적인 소프트웨어나 프로그램을 모두 일컬어 멀웨어라는 용어를 사용한다.
#### 멀웨어의 종류
> 1. 컴퓨터 바이러스: 자기 전염 기능이 있고 공격까지 잠복 기간이 있다. 단독으로 존재할 수 없으며, 기존 프로그램에 기생해서 전염된다.
> 2. 웜: 네트워크 등을 이용하여 침입하고 독립적으로 전염되며, 다른 프로그램 등 작동에 악영향을 미친다.
> 3. 트로이 목마: 정상적인 프로그램이나 소프트웨어로 위장하여 침입한 후 다른 프로그램 작동에 악영향을 미친다. 원칙적으로 본체에 자기 전염 기능은 없다.
> 4. 스파이 웨어: 키보드나 마우스 조작 표시 화면 등을 감시하고 기록해서 외부로 유출 시킨다. 자기 전염 기능은 없다.


## 75. 암호화 기술
### 암호화란 어떤 방법으로든 데이터를 해독할 수 없는 상태로 변환하는 것이다. 이때 암호화에 사용된 계산 방법을 알고 있다면 암호화된 데이터에서 원래 데이터로 되돌릴 수 있다.
#### 암호화 처리 절차나 계산 방법을 암호 알고리즘이라고 하고 알고리즘 계산에 사용하는 특정한 부호를 키 라고 한다. 알고리즘이 알려져 있어도 계산에 사용한 키가 없으면 암호화도 복호화도 할 수 없다. 암호의 기밀성은 키로 유지 된다.
#### 해시 함수란 원본 데이터(평문)에 대해 일정한 처리를 한 결과(해시 값)를 출력하는 함수이다.
#### 다른 암호화 방식과는 달리 암호화에 사용하는 키는 없으며, 키를 사용해서 복호화 하는 것도 불가능하다.
#### 평문과 해시 값은 일대일로 대응되는데 해시 값을 계산하여 평문으로 되돌리는 것은 거의 불가능하다. 이런 특성 때문에 비밀번호 저장이나 데이터 변조 방지 등에도 이용된다.
#### 해시 함수에서는 같은 데이터에서 반드시 같은 해시 값이 출력되므로 입력한 값을 해시 함수로 처리한 결과와 등록된 값이 일치하는지 여부로 비밀번호를 검증한다.


## 76. 공통키 암호화 방식/공개키 암호화 방식
#### 암호화에 사용하는 키(공통키)를 데이터 송신자와 수신자가 양쪽에서 비밀리에 공유하여 암호화 통신을 수행하는 방식을 '공통키 암호화 방식'이라고 한다.
#### 공통키를 안전하게 공유해야 하는데 네트워크로 교환할 때 유출될 위험이 있다.
#### 암호화와 복호화에 키(공개키와 개인키)를 2개 사용하여 암호화 통신을 하는 방식을 '공개키 암호화 방식'이라고 한다.
#### 공개키 암호화 방식에서는 송신자는 수신자가 공유한 공개키를 사용하여 원본 데이터를 암호화하여 전송하고 수신자는 자신이 가진 개인키로 암호화된 데이터를 복호화 한다.
#### 암호화와 복호화에 사용하는 키가 다르기 때문에 복호화에 사용하는 개인키를 자신만 알고 있으면 네트워크로 공개키를 전송해도 안전하다.
#### 공개키 암호화 방식은 공개키를 네트워크상에서 공유할 수 있으므로 HTTPS 통신이나 VPN 통신의 네고시에이션, 키 교환, 전자 서명 등에 이용된다.
#### 공개키 암호화 방식에서 송신자가 자신의 개인키로 데이터를 암호화해 전송하면, 수신자는 공개키로 데이터를 복호화 할 수 있다. 암호화된 데이터를 송신자의 공개키로 복호화할 수 있다는 사실은 해당 데이터가 송신자만 가지고 있는 개인키로 암호화되었다는 것을 증명한다. 이 원리를 이용한 것이 전자 서명이다.



## 77. 서버 인증서/인증 기관
#### 통신이 암호화되어 있더라도 접속한 곳이 위조된 웹 페이지나 공격자의 웹 페이지라면 의미가 없다. 이를 방지하고자 사용되는것이 서버 인증서이다.
#### 서버 인증서는 공개키 암호화 방식을 이용한 전자 서명을 통해 인증 기관(CA)이 본인임을 인증해 주는 인터넷상의 체계입니다.
#### HTTPS 통신에서는 패킷을 암호화하기 전에 접속한 곳에서 서버 인증서를 받아 정당성을 검증한뒤 정당한 웹 페이지라면 연결되는 곳의 웹 서버와 암호화 방식이나 키 정보를 교환하고 암호화 통신을 시작한다.
#### 인증 기관은 HTTPS 통신 등에서 서버 인증서를 발급하고, 접속하는 웹 서버 등 적법성을 인증하는 기관이다.



## 78. SSL/TLS
### SSL과 TLS는 암호화 통신을 수행하는 절차를 규정한 프로토콜이다. 공개키 암호화 방식을 이용하여 연결 대상의 정당성을 확인한 후 암호화 통신에 필요한 키를 생성하고, 패킷 암호화와 복호화를 실행한다.
#### SSL과 TLS는 모두 웹 브라우저와 웹 서버 간 통신을 암호화하는 프로토콜이다. SSL은 웹 브라우저 개발사에서 만든 프로토콜이었기 때문에 인터넷 기술 표준화 단체인 IETF가 TLS로 다시 설계하여 인터넷 표준으로 삼았다. 이후 SSL과 TLS 1.1 이전의 프로토콜에 취약성이 발견되에 현재는 권장하지 않게 되었고 현재는 TLS 1.2와 TLS 1.3이 정식 프로토콜이다.
#### TLS에 의한 암호화 통신은 공개키 암호화 방식을 이용한다.
#### 먼저 웹 브라우저는 웹 서버에서 공개키를 받아 인증서를 검증하고 받은 공개키로 암호화 통신용 키 생성에 필요한 정보(난수)를 암호화해서 웹 서버에 보낸다. 웹 서버는 그 난수를 개인키로 복호화하여 암호화 통신용 키를 생성한다. 이 방법으로 키 자체를 네트워크에 보내지 않으면서 웹 브라우저와 웹서버 사이에서 암호화 통신용 키를 공유한다.



## 79. 방화벽
### 방화벽은 네트워크 세그먼트 경계에 설치되는 게이트웨이의 일종이다. 주된 역할은 외부에서 들어오는 불필요한 패킷이나 수상한 접속 등을 차단하는 것이다.
#### 일반적으로 인터넷과 LAN의 경계인 에지 라우터 바로 뒤(내부)에 설치된다. 방화벽 기능은 패킷의 종류와 내용을 확인하여 LAN내부로 통과시킬지 여부를 결정한다.
#### 패킷의 IP 주소를 확인해서 자신이 관리하는 LAN으로 전송되는지 여부를 기준으로 하는 라우터와 달리 방화벽은 패킷의 IP 주소, 포트 번호, 패킷 내용 정보를 확인해서 통과 여부를 제어한다.
#### 방화벽의 종류
> - 패킷 필터링형: ip 주소나, 포트 번호를 기준으로 통과시킬 패킷을 제어한다.
>   > 1. 스태틱형: 차단하거나 통과시킬 ip 주소나 포트 번호를 고정리스트로 관리하는 방식
>   > 2. 다이내믹형: 특정 통신에 대한 응답이면 허용하는 등 동적인 리스트로 관리
>   > 3. 스테이트풀형: 패킷 단독이 아니라 프로토콜 순서도 감시하여 부정한 액세스를 차단한다.
> - 게이트웨이형: 네트워크의 게이트 웨이로서 모든 통신을 제어한다. 네트워크 내부와 외부 모두 방화벽이 창구 역할을 하기 때문에 프록시형이라고도 한다.


## 80. DMZ
### DMZ는 외부 네트워크와 내부 네트워크 사이에 설치하는 네트워크상의 세그먼트를 의미한다. 외부 액세스가 필요한 서버와 외부에 공개 하지 않는 내부 네트워크를 모두 보호하는 데 이용된다.
#### 웹 서버는 웹 사이트를 인터넷에 공개할 때 인터넷을 통해 웹 서버에 엑세스할 수 있게 한다. 이 때 웹 서버는 에지 라우터보다 안쪽 세그먼트에 두게 되는데, 외부에서 오는 무작위 패킷이 내부까지 도달하는 것은 보안상 위험요소이므로 웹 서버를 배치한 세그먼트를 방화벽 등으로 격리해서 내부 네트워크를 보호하는 것이다.
#### 실제 네트워크에서는 DMZ 앞뒤로 방화벽을 배치하기도 합니다. 라우터 제품에는 방화벽 기능을 갖춘 제품이나 DMZ 설정 기능을 갖춘 제품 등이 있어 유연하게 DMZ 환경을 구축할 수 있다.



## 81. IDS/IPS
#### 방화벽의 방어 정책은 입구의 방어력을 높이고 검문을 강화하여 내부 안전을 확보하는 것이다. 그러나 공격자 수법이 고도화되면서 입구만 강화해서는 침입을 막을 수 없게 되었다.
#### 그래서 부정한 패킷이 통과한 후 내부에서 침입을 탐지하고 제거할 수 있는 시스템이 필요하다.
#### IDS는 부정한 패킷의 침입을 탐지하고, IPS는 부정한 패킷을 탐지하여 방지하는 시스템이다.
#### 탐지 방법은 스테이트풀형과 마찬가지로 IP주소와 포트 번호 뿐만 아니라 프로토콜 순서와 처리 상황 등도 검증한다.
#### IDS와 IPS는 설치 장소에따라 호스트형과 네트워크 형으로 나뉘는데 호스트형은 서버에 소프트형으로 설치되어 부정한 패킷을 검사하고 네트워크형은 네트워크상에서 흐르는 패킷을 감시한다.
#### 이외에도 웹 사이트의 취약점을 노리는 공격에서 보호하는 여러 기능을 방화벽에 통합한 UTM같은 시스템도 있다.



## 82. VPN/터널
### VPN은 일반에 공개되어 불특정 다수와 연결되는 네트워크에 특정 상대만 이용할 수 있는 전용선을 가상으로 구축하는 기술이다. VPN통신은 암호화 등으로 보호된다.
#### 호스트(일반적으로 라우터)를 VPN으로 연결하면 연결 대상과 교환하는 패킷이 암호화 된다. VPN 통신의 패킷은 다른 패킷과 마찬가지로 여러 라우터를 거쳐서 연결 대상까지 도달하지만, 중계하는 라우터는 패킷 내용을 해독할 수 없으므로 경로는 보호된 상태이다.
#### 이러한 기술을 터널이라고 하는데 본래 터널이라는 용어는 프로토콜을 패킷을 다른 프로토콜의 패킷에 실어 전송하는 기술을 가리키는 것이지 경로 암호화는 필수가 아니다.
#### 경로 내에 다른 프로토콜의 네트워크가 있을때는 패킷을 원활하게 전달할 수 있는 터널을 사용하는 것이 유용하다. 이런 처리를 캡슐화라고 한다.
#### VPN의 대표적인 프로토콜
> 1. IPsec: 연결 대상의 인증 기능과 패킷의 암호화 기능을 갖춘 프로토콜, 인터넷 표준 되었다.
> 2. L2TP: 패킷 암호화는 하지 않고 터널로 연결 대상과 전용 경로를 구축하는 프로토콜
> 3. PPTP: 윈도에서 표준으로 사용되던 프로토콜
> 4. SSL-VPN: SSL을 사용하므로 웹 브라우저 연결을 VPN으로 사용하고자 할 때 이용한다. SSL-VPN은 HTTPS를 사용해서 암호화와 터널을 구현한다.



## 83. 트래픽 감시/로그 감시
#### 네트워크에서 수상한 동작을 검출하려면 네트워크 트래픽을 감시해야 한다. 평소 발생하지 않는 해외 접속이나 통신이 있는지나 서버의 이벤트 로그를 확인하여 수상한 통신, 중요 데이터에 대한 액세스나 로그인 오류 등이 있는지 확인한다.
#### 트래픽 감시는 차세대 방화벽과 같은 고기능인 제품이나 패킷 캡처 기능이 있는 네트워크 기기를 이용한다. 이런 장비의 기능을 이용하면 네트워크를 흐르는 패킷을 상시 체크할 수 있으므로 거의 실시간으로 이상을 탐지할 수 있다.
#### 로그 감시는 서버의 로그 파일을 소프트웨어로 해석한다. 로그 감시는 과거 발생 상황을 조사하게 된다.
